(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{373:function(t,e,r){var content=r(475);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(43).default)("c08d4d80",content,!0,{sourceMap:!1})},474:function(t,e,r){"use strict";r(373)},475:function(t,e,r){var o=r(42)(!1);o.push([t.i,".form[data-sufm]{margin:2rem auto 4rem;position:relative;padding:0 var(--x-padding) 2.5rem;display:grid;max-width:612px}.sign-in-alt[data-sufm],.submit[data-sufm]{width:calc(100% - 3rem);display:flex;max-width:612px;margin:2.75rem auto}.submit[data-sufm] .loader{margin-right:1rem}.root[data-sufm] .root[data-tde]{padding:0 .5rem}.root[data-sufm] .content[data-tde]{font-size:1.15rem}.root[data-sufm] .heart-beat.delayed{-webkit-animation-delay:1.2s;animation-delay:1.2s}.root[data-sufm] .sign-up-password .input-hint{color:var(--hint-color)}",""]),t.exports=o},586:function(t,e,r){"use strict";r.r(e);r(16),r(11),r(12),r(17),r(10),r(18);var o=r(1),n=r(6),main=(r(29),r(20),r(36),r(74),r(0));function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function l(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var d={events:["updateTemplate","submitting-form","account-created"],name:"SignUpForm",props:{nameValidator:{type:Function,required:!0},emailValidator:{type:Function,required:!0},passwordValidator:{type:Function,required:!0},creatingAccount:{type:Boolean,required:!0}},data:function(){return{formKey:"undefined",form:{name:"",username:"",email:"",password:"",showPassword:!1,agreed:!1},creatingAccountComponent:!1}},computed:{supabase:function(){return this.$store.getters.supabase}},methods:{resetSignUp:function(){this.form={name:"",username:"",email:"",password:"",showPassword:!1,agreed:!1},this.formKey=performance.now()}},render:function(t){var e,r,n=this,c={"data-sufm":""},div=function(e,r){return t("div",e,r)},input=function(e){return t("ui-input",e)};return div({attrs:l({},c),staticClass:"root"},[this.$slots.prepend,[this.$slots.socials,function(e,r){return t("ui-form",e,r)}({key:this.formKey,props:{name:"sign up",submitData:{attrs:l({},c),props:{background:"info",flat:!0,disabled:this.creatingAccount||this.creatingAccountComponent},staticClass:"submit"},submitText:"Create Account"},attrs:l(l({},c),{},{action:".",autocomplete:"on","aria-label":"create account"}),staticClass:"form fill-before",on:{"submit-form":function(){n.creatingAccountComponent=!0,n.$emit("submitting-form"),n.supabase.auth.user()&&n.supabase.auth.signOut(),n.supabase.auth.signUp({email:n.form.email,password:n.form.password}).then((function(t){n.creatingAccountComponent=!1,t.error||main.addUser.call(n,{email:n.form.email,name:n.form.name,user:(null==t?void 0:t.user)||{}}).then(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(201!=r.status){e.next=9;break}return n.$emit("account-created",n.form),n.$store.commit("UPDATE_",{name:"user",value:l(l({},n.$store.state.user),null==t?void 0:t.user)}),n.$emit("updateTemplate","account-created"),n.$store.commit("UPDATE_",{value:l(l({},n.$store.state.user),{},{awaitingSignIn:{email:n.form.email,password:n.form.password}}),name:"user"}),e.next=7,main.sleep.call(n,200);case 7:n.resetSignUp(),n.$nextTick((function(){n.$emit("reset-form")}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}}},[(this.creatingAccount||this.creatingAccountComponent)&&div({staticClass:"submit-button-wrapper",slot:"submitText"},[(e={attrs:{size:"1.5rem"},staticClass:"loader"},t("app-loader",e,r)),"Creating Account"]),[{label:"Name",validator:this.nameValidator,placeholder:"Egwu Sade"},{label:"Email",pattern:"^\\s*?[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*\\s*?$",type:"email",validator:this.emailValidator,placeholder:"example@domain",hint:"You will need to verify your email"},{label:"Password",autocomplete:"new-password",placeholder:"6+ characters",showPassword:this.form.showPassword,type:"password",validator:this.passwordValidator,hint:this.form.password&&!0===this.passwordValidator(this.form.password)&&!this.form.showPassword?"Double check your password":void 0,attentionHint:!0,passwordToggle:{class:{"heart-beat delayed":!0===this.passwordValidator(this.form.password)}}}].map((function(t,e){var r=t.label.toLowerCase(),c={vmodel:function(t){n.form[r]=t,n.form.agreed=!1}};"password"==r&&(c["append-click"]=function(){n.form.showPassword=!n.form.showPassword});var d="Email"==t.label?function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(e){var r,o,c,l,d,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.supabase.from("users").select("email");case 3:return r=t.sent,o=r.data,c=r.error,l={valid:null,message:null},o&&!c?(null==o||null===(d=o.find)||void 0===d?void 0:d.call(o,(function(t){var r,o;return(null===(r=(o=t.email).toLowerCase)||void 0===r?void 0:r.call(o))==e.toLowerCase()})))?(l.valid=!1,l.message="Account exists"):(l.valid=!0,l.message=""):(l.valid=!1,l.message="Error fetching"),t.abrupt("return",l);case 11:if(t.prev=11,t.t0=t.catch(0),console.log(t.t0),!t.t0){t.next=17;break}return m=/network request failed/i.test(t.t0.message),t.abrupt("return",{valid:!1,message:m||!n.$nuxt.isOnline?"Network error":"Error"});case 17:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}():void 0;return input({key:e,props:{readonly:n.creatingAccountComponent,type:t.type||"text",label:t.label,autocomplete:t.autocomplete||r,id:"sign-up-".concat(r),vmodel:n.form[r],validator:t.validator,pattern:t.pattern||".+",showPassword:t.showPassword,placeholder:t.placeholder,asyncValidator:d,hint:t.hint,attentionHint:t.attentionHint,passwordToggle:t.passwordToggle},on:l({},c)})})),input({props:{label:"Agree to terms and conditions",id:"delivery-agreed",type:"switch",vmodel:this.form.agreed,required:!0,validator:function(t){return!!t||"Required"},hint:"By signing up, you have agreed to our <span>terms and conditions</span>"},on:{vmodel:function(t){n.form.agreed=t}}}),div({slot:"append",attrs:l({},c),staticClass:"form-append"},[function(e,r){return t("text-divide",e,r)}(["Have an account?"]),function(e,r){return t("ui-btn",e,r)}({props:{text:!0,color:"info",tag:"nuxt-link",to:"".concat(this.$route.path,"?dialog=sign-in"),filledText:!0,actionButton:!0},style:{opacity:this.creatingAccount?"var(--t-disabled)":void 0},attrs:l(l({},c),{},{title:"click to sign in"}),staticClass:"sign-in-alt"},["Sign in"])])])]])}},m=(r(474),r(9)),component=Object(m.a)(d,undefined,undefined,!1,null,null,null);e.default=component.exports}}]);